<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¢Ù…ÙˆØ²Ø´ Ùˆ Ø¢Ø²Ù…ÙˆÙ† Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #e5e7eb;
        }
        .telegram-bg {
            background-color: #8774e1;
            background-image: url('https://web.telegram.org/a/assets/patterns/chat-bg-pattern-dark.ad382488d78536d9339d.png');
            background-size: 500px;
        }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.2); border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(0,0,0,0.3); }

        .message-bubble-in { background-color: #ffffff; border-radius: 18px 18px 18px 4px; }
        .message-bubble-out { background-color: #eefdde; border-radius: 18px 18px 4px 18px; }
        
        .typing-indicator span {
            height: 8px; width: 8px; background-color: #a0a0a0; display: inline-block;
            border-radius: 50%; animation: typing 1.4s infinite;
        }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing {
            0%, 100% { opacity: 0.2; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1); }
        }
        .chat-item.active-chat { background-color: #3390ec; }
        .chat-item.active-chat h3, .chat-item.active-chat p, .chat-item.active-chat span { color: white; }

        /* Quiz Styles */
        .quiz-option {
            background-color: #f0f2f5; border: 2px solid transparent;
            transition: all 0.2s ease-in-out;
        }
        .quiz-option:hover { background-color: #e5e7eb; }
        .quiz-option.selected { border-color: #3b82f6; background-color: #dbeafe; }
        .quiz-option.correct { border-color: #22c55e; background-color: #dcfce7; }
        .quiz-option.incorrect { border-color: #ef4444; background-color: #fee2e2; }
    </style>
</head>
<body class="overflow-hidden">

    <div class="container mx-auto h-screen p-0 md:p-4">
        <div class="flex h-full max-h-full w-full max-w-7xl mx-auto bg-white rounded-none md:rounded-2xl shadow-lg overflow-hidden">

            <!-- Sidebar - Chat List -->
            <aside id="chat-list-container" class="w-full md:w-1/3 lg:w-1/4 h-full bg-[#f0f2f5] border-l border-gray-200 flex flex-col transition-transform duration-300 ease-in-out md:transform-none z-20 md:relative">
                <header class="p-3 border-b border-gray-200 flex items-center gap-3 bg-white">
                     <button id="menu-button" class="p-2 rounded-full hover:bg-gray-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>
                    </button>
                    <h1 class="text-lg font-bold text-gray-800">Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø±</h1>
                </header>

                <div class="flex-1 overflow-y-auto custom-scrollbar">
                    <ul id="chat-list">
                        <li class="chat-item" data-chat="intro">
                            <div class="flex items-center p-3 cursor-pointer hover:bg-gray-200 border-b"><img class="w-12 h-12 rounded-full ml-3" src="https://placehold.co/100x100/8774E1/FFFFFF?text=ğŸ‘‹" alt="Ù…Ø¹Ø±ÙÛŒ"><div class="flex-1"><h3 class="font-semibold">Ù…Ø¹Ø±ÙÛŒ Ø¯ÙˆØ±Ù‡</h3><p class="text-sm text-gray-600 truncate">Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯! Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø§ÛŒÙ†Ø¬Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.</p></div></div>
                        </li>
                        <li class="chat-item" data-chat="lesson1">
                            <div class="flex items-center p-3 cursor-pointer hover:bg-gray-200 border-b"><img class="w-12 h-12 rounded-full ml-3" src="https://placehold.co/100x100/42A5F5/FFFFFF?text=Û±" alt="Ø¯Ø±Ø³ Û±"><div class="flex-1"><h3 class="font-semibold">Ø¯Ø±Ø³ Û±: Ù…Ø§Ù‡ÛŒØª Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø±</h3><p class="text-sm text-gray-600 truncate">Ø®ØµÙˆØµÛŒØ§Øª Ùˆ ØªÙØ§ÙˆØª Ø¨Ø§ Ø³Ø®Øªâ€ŒØ§ÙØ²Ø§Ø±</p></div></div>
                        </li>
                        <li class="chat-item" data-chat="lesson2">
                            <div class="flex items-center p-3 cursor-pointer hover:bg-gray-200 border-b"><img class="w-12 h-12 rounded-full ml-3" src="https://placehold.co/100x100/66BB6A/FFFFFF?text=Û²" alt="Ø¯Ø±Ø³ Û²"><div class="flex-1"><h3 class="font-semibold">Ø¯Ø±Ø³ Û²: ÙØ±Ø¢ÛŒÙ†Ø¯ Ùˆ Ù…Ø¯Ù„â€ŒÙ‡Ø§</h3><p class="text-sm text-gray-600 truncate">Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ø¢Ø¨Ø´Ø§Ø±ÛŒØŒ Ø§ÙØ²Ø§ÛŒØ´ÛŒ Ùˆ ØªÚ©Ø§Ù…Ù„ÛŒ</p></div></div>
                        </li>
                        <li class="chat-item" data-chat="lesson3">
                            <div class="flex items-center p-3 cursor-pointer hover:bg-gray-200 border-b"><img class="w-12 h-12 rounded-full ml-3" src="https://placehold.co/100x100/FFA726/FFFFFF?text=Û³" alt="Ø¯Ø±Ø³ Û³"><div class="flex-1"><h3 class="font-semibold">Ø¯Ø±Ø³ Û³: ØªÙˆØ³Ø¹Ù‡ Ú†Ø§Ø¨Ú© (Agile)</h3><p class="text-sm text-gray-600 truncate">ÙÙ„Ø³ÙÙ‡ØŒ Ø§ØµÙˆÙ„ Ùˆ Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ XP Ùˆ Scrum</p></div></div>
                        </li>
                        <li class="chat-item" data-chat="lesson4">
                            <div class="flex items-center p-3 cursor-pointer hover:bg-gray-200 border-b"><img class="w-12 h-12 rounded-full ml-3" src="https://placehold.co/100x100/EF5350/FFFFFF?text=Û´" alt="Ø¯Ø±Ø³ Û´"><div class="flex-1"><h3 class="font-semibold">Ø¯Ø±Ø³ Û´: Ø§ØµÙˆÙ„ Ø±Ø§Ù‡Ù†Ù…Ø§</h3><p class="text-sm text-gray-600 truncate">Ø§ØµÙˆÙ„ Ù‡Ø³ØªÙ‡â€ŒØ§ÛŒ Ùˆ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ÙØ±Ø¢ÛŒÙ†Ø¯</p></div></div>
                        </li>
                        <li class="chat-item" data-chat="quiz">
                            <div class="flex items-center p-3 cursor-pointer hover:bg-gray-200 bg-green-50"><img class="w-12 h-12 rounded-full ml-3" src="https://placehold.co/100x100/26A69A/FFFFFF?text=âœ”ï¸" alt="Ø¢Ø²Ù…ÙˆÙ†"><div class="flex-1"><h3 class="font-bold text-green-700">Ø¢Ø²Ù…ÙˆÙ† Ø¢Ù†Ù„Ø§ÛŒÙ†</h3><p class="text-sm text-green-600 truncate">Ø¯Ø§Ù†Ø´ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø³Ù†Ø¬ÛŒØ¯!</p></div></div>
                        </li>
                    </ul>
                </div>
            </aside>

            <!-- Main Content - Chat Window -->
            <main id="main-content" class="flex-1 flex-col h-full telegram-bg hidden md:flex">
                <header class="p-3 border-b border-gray-200/20 flex justify-between items-center bg-white/10 backdrop-blur-sm text-white">
                    <div class="flex items-center">
                        <button id="back-button" class="p-2 rounded-full hover:bg-black/20 md:hidden mr-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg></button>
                        <div class="flex items-center cursor-pointer"><img id="chat-header-img" class="w-10 h-10 rounded-full object-cover ml-3" src="" alt="Avatar"><div><h2 id="chat-header-title" class="text-lg font-semibold"></h2><p id="chat-header-status" class="text-xs text-gray-300"></p></div></div>
                    </div>
                </header>

                <div id="messages-container" class="flex-1 overflow-y-auto p-4 md:p-6 custom-scrollbar">
                    <!-- Messages & Quiz will be injected here by JS -->
                </div>

                <footer id="message-footer" class="p-3 bg-transparent">
                    <div class="flex items-center bg-white p-2 rounded-xl shadow-sm"><input type="text" placeholder="Ø§ÛŒÙ† ÛŒÚ© Ù†Ø³Ø®Ù‡ Ù†Ù…Ø§ÛŒØ´ÛŒ Ø§Ø³Øª" class="w-full bg-transparent focus:outline-none px-3 text-gray-700" disabled><button class="p-3 bg-blue-500 text-white rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg></button></div>
                </footer>
            </main>
            
            <div id="placeholder" class="flex-1 h-full telegram-bg flex-col items-center justify-center text-center p-8 text-white hidden md:flex"><div class="bg-black/10 backdrop-blur-md p-6 rounded-2xl"><h2 class="text-2xl font-bold">Ø¯ÙˆØ±Ù‡ Ø¢Ù…ÙˆØ²Ø´ Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø±</h2><p class="mt-2 text-gray-200">ÛŒÚ© Ø¯Ø±Ø³ Ø±Ø§ Ø§Ø² Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ ØªØ§ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ø±Ø§ Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒÙ….</p></div></div>
        </div>
    </div>

    <!-- Online Users Counter Script -->
    <script id="_wauz9d">var _wau = _wau || []; _wau.push(["dynamic", "1yzxeoicrj", "z9d", "1c4587ffffff", "small"]);</script><script async src="//waust.at/d.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        // Data Objects
        const chatData = {
            intro: {
                title: 'Ù…Ø¹Ø±ÙÛŒ Ø¯ÙˆØ±Ù‡', img: 'https://placehold.co/100x100/8774E1/FFFFFF?text=ğŸ‘‹', status: 'Ø¢Ù†Ù„Ø§ÛŒÙ†',
                messages: [
                    { type: 'in', text: 'Ø³Ù„Ø§Ù…! Ø¨Ù‡ Ø¯ÙˆØ±Ù‡ ØªØ¹Ø§Ù…Ù„ÛŒ Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø± Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.' },
                    { type: 'in', text: 'Ø¯Ø± Ø§ÛŒÙ† Ø¯ÙˆØ±Ù‡ØŒ Ù…Ø¨Ø§Ø­Ø« Ú©Ù„ÛŒØ¯ÛŒ Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø± Ø±Ø§ Ø¯Ø± Ù‚Ø§Ù„Ø¨ Ú¯ÙØªÚ¯Ùˆ ÛŒØ§Ø¯ Ù…ÛŒâ€ŒÚ¯ÛŒØ±ÛŒØ¯.' },
                    { type: 'in', text: 'Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ØŒ ÛŒÚ©ÛŒ Ø§Ø² Ø¯Ø±Ø³â€ŒÙ‡Ø§ Ø±Ø§ Ø§Ø² Ù…Ù†ÙˆÛŒ Ú©Ù†Ø§Ø± Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯. Ù¾Ø³ Ø§Ø² Ù…Ø·Ø§Ù„Ø¹Ù‡ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¯Ø± Ø¢Ø²Ù…ÙˆÙ† Ø¢Ù†Ù„Ø§ÛŒÙ† Ø´Ø±Ú©Øª Ú©Ù†ÛŒØ¯.' },
                ]
            },
            lesson1: {
                title: 'Ø¯Ø±Ø³ Û±: Ù…Ø§Ù‡ÛŒØª Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø±', img: 'https://placehold.co/100x100/42A5F5/FFFFFF?text=Û±', status: 'Ø¢Ù†Ù„Ø§ÛŒÙ†',
                messages: [
                    { type: 'q', text: 'Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ú†Ù‡ Ù†Ù‚Ø´ Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø§ÛŒ Ø¯Ø§Ø±Ø¯ØŸ' },
                    { type: 'a', text: 'Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ù‡Ù… Ù†ÙˆØ¹ÛŒ Ù…Ø­ØµÙˆÙ„ Ø§Ø³Øª Ùˆ Ù‡Ù…Ø²Ù…Ø§Ù† ÙˆØ³ÛŒÙ„Ù‡ Ø§ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ­ÙˆÛŒÙ„ ÛŒÚ© Ù…Ø­ØµÙˆÙ„ Ù…Ø­Ø³ÙˆØ¨ Ù…ÛŒØ´ÙˆØ¯.' },
                    { type: 'q', text: 'Ø®ØµÙˆØµÛŒØ§Øª Ø§ØµÙ„ÛŒ Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ú©Ù‡ Ø¢Ù† Ø±Ø§ Ø§Ø² Ø³Ø®Øª Ø§ÙØ²Ø§Ø± Ù…ØªÙ…Ø§ÛŒØ² Ù…ÛŒÚ©Ù†Ø¯ Ú†ÛŒØ³ØªØŸ' },
                    { type: 'a', text: 'Û±. ÛŒÚ© Ø¹Ù†ØµØ± Ù…Ù†Ø·Ù‚ÛŒ Ø§Ø³Øª ØªØ§ ÙÛŒØ²ÛŒÚ©ÛŒ<br>Û². Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ùˆ Ø¨Ø³Ø· Ø¯Ø§Ø¯Ù‡ Ù…ÛŒØ´ÙˆØ¯ Ù†Ù‡ Ø§ÛŒÙ†Ú©Ù‡ Ø³Ø§Ø®ØªÙ‡ Ø´ÙˆØ¯.<br>Û³. ÙØ±Ø³ÙˆØ¯Ù‡ Ù†Ù…ÛŒØ´ÙˆØ¯.<br>Û´. Ø§ØºÙ„Ø¨ Ø¨Ù‡ ØµÙˆØ±Øª Ø³ÙØ§Ø±Ø´ÛŒ Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒØ´ÙˆØ¯.' },
                    { type: 'q', text: 'Ú†Ø±Ø§ Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± ÙØ±Ø³ÙˆØ¯Ù‡ Ù†Ù…ÛŒØ´ÙˆØ¯ Ø¨Ù„Ú©Ù‡ Ø²ÙˆØ§Ù„ Ù…ÛŒÛŒØ§Ø¨Ø¯ØŸ' },
                    { type: 'a', text: 'Ú†ÙˆÙ† Ø¨Ù‡ Ù†Ø§Ù…Ù„Ø§ÛŒÙ…Ø§Øª Ù…Ø­ÛŒØ·ÛŒ Ù†ÙÙˆØ° Ù¾Ø°ÛŒØ± Ù†ÛŒØ³Øª. Ø§Ù…Ø§ Ø¨Ø§ Ù‡Ø± ØªØºÛŒÛŒØ± Ùˆ Ø§ØµÙ„Ø§Ø­ØŒ Ø§Ø­ØªÙ…Ø§Ù„ ÙˆØ±ÙˆØ¯ Ø¹ÛŒÙˆØ¨ Ø¬Ø¯ÛŒØ¯ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯ Ú©Ù‡ Ø¨Ø§Ø¹Ø« Ø®ÛŒØ² Ù†Ø§Ú¯Ù‡Ø§Ù†ÛŒ Ø¯Ø± Ù…Ù†Ø­Ù†ÛŒ Ø¢Ù‡Ù†Ú¯ Ø´Ú©Ø³Øª Ù…ÛŒØ´ÙˆØ¯. Ø§ÛŒÙ† ÙØ±Ø¢ÛŒÙ†Ø¯ "Ø²ÙˆØ§Ù„" Ù†Ø§Ù…ÛŒØ¯Ù‡ Ù…ÛŒØ´ÙˆØ¯.' },
                ]
            },
            lesson2: {
                title: 'Ø¯Ø±Ø³ Û²: ÙØ±Ø¢ÛŒÙ†Ø¯ Ùˆ Ù…Ø¯Ù„â€ŒÙ‡Ø§', img: 'https://placehold.co/100x100/66BB6A/FFFFFF?text=Û²', status: 'Ø¢Ù†Ù„Ø§ÛŒÙ†',
                messages: [
                    { type: 'q', text: 'Ù„Ø§ÛŒÙ‡ Ù‡Ø§ÛŒ Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ú©Ø¯Ø§Ù…Ù†Ø¯ØŸ' },
                    { type: 'a', text: 'Ø§Ø² Ù¾Ø§ÛŒÛŒÙ† Ø¨Ù‡ Ø¨Ø§Ù„Ø§: Û±. ØªÙˆØ¬Ù‡ Ø¨Ù‡ Ú©ÛŒÙÛŒØª (Quality Focus) Û². ÙØ±Ø¢ÛŒÙ†Ø¯Ù‡Ø§ (Processes) Û³. Ø±ÙˆØ´Ù‡Ø§ (Methods) Û´. Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ (Tools)' },
                    { type: 'q', text: 'Ù…Ø¯Ù„ Ø¢Ø¨Ø´Ø§Ø±ÛŒ (Waterfall) Ú†ÛŒØ³Øª Ùˆ Ú†Ù‡ Ù…Ø´Ú©Ù„Ø§ØªÛŒ Ø¯Ø§Ø±Ø¯ØŸ' },
                    { type: 'a', text: 'ÛŒÚ© Ø±ÙˆØ´ Ø³ÛŒØ³ØªÙ…Ø§ØªÛŒÚ© Ùˆ ØªØ±ØªÛŒØ¨ÛŒ Ø§Ø³Øª. Ù…Ø´Ú©Ù„Ø§Øª Ø§ØµÙ„ÛŒ Ø¢Ù†: Û±. Ù¾Ø±ÙˆÚ˜Ù‡ Ù‡Ø§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ù‡ Ù†Ø¯Ø±Øª ØªØ±ØªÛŒØ¨ÛŒ Ù‡Ø³ØªÙ†Ø¯. Û². Ù…Ø´ØªØ±ÛŒ Ø¨Ø§ÛŒØ¯ ØªØ§ Ø§Ù†ØªÙ‡Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¯Ù† Ù†Ø³Ø®Ù‡ Ú©Ø§Ø±ÛŒ ØµØ¨Ø± Ú©Ù†Ø¯. Û³. Ø¨Ø±Ø®ÛŒ Ø§Ø¹Ø¶Ø§ÛŒ ØªÛŒÙ… Ø¨Ø§ÛŒØ¯ Ù…Ù†ØªØ¸Ø± Ø¯ÛŒÚ¯Ø±Ø§Ù† Ø¨Ù…Ø§Ù†Ù†Ø¯.' },
                    { type: 'q', text: 'Ù…Ø¯Ù„ Ù…Ø§Ø±Ù¾ÛŒÚ†ÛŒ (Spiral) Ú†ÛŒØ³ØªØŸ' },
                    { type: 'a', text: 'ÛŒÚ© Ù…Ø¯Ù„ ØªÚ©Ø§Ù…Ù„ÛŒ Ø§Ø³Øª Ú©Ù‡ Ù…Ø§Ù‡ÛŒØª ØªÚ©Ø±Ø§Ø±ÛŒ Ù…Ø¯Ù„ Ù†Ù…ÙˆÙ†Ù‡ Ø³Ø§Ø²ÛŒ Ø±Ø§ Ø¨Ø§ Ø¬Ù†Ø¨Ù‡ Ù‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ÛŒ Ùˆ Ø³ÛŒØ³ØªÙ…Ø§ØªÛŒÚ© Ù…Ø¯Ù„ Ø¢Ø¨Ø´Ø§Ø±ÛŒ ØªÙ„ÙÛŒÙ‚ Ù…ÛŒÚ©Ù†Ø¯. Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ø¨Ù‡ ØµÙˆØ±Øª ÛŒÚ© Ø³Ø±ÛŒ Ù†Ú¯Ø§Ø±Ø´Ù‡Ø§ÛŒ ØªÚ©Ø§Ù…Ù„ÛŒ ØªÙˆØ³Ø¹Ù‡ Ù…ÛŒÛŒØ§Ø¨Ø¯.' },
                ]
            },
            lesson3: {
                title: 'Ø¯Ø±Ø³ Û³: ØªÙˆØ³Ø¹Ù‡ Ú†Ø§Ø¨Ú© (Agile)', img: 'https://placehold.co/100x100/FFA726/FFFFFF?text=Û³', status: 'Ø¢Ù†Ù„Ø§ÛŒÙ†',
                messages: [
                    { type: 'q', text: 'Ø¨ÛŒØ§Ù†ÛŒÙ‡ Ú†Ø§Ø¨Ú© (Agile Manifesto) Ø¨Ø± Ú†Ù‡ Ø§Ø±Ø²Ø´Ù‡Ø§ÛŒÛŒ ØªØ£Ú©ÛŒØ¯ Ø¯Ø§Ø±Ø¯ØŸ' },
                    { type: 'a', text: 'Û±. Ø§ÙØ±Ø§Ø¯ Ùˆ ØªØ¹Ø§Ù…Ù„Ù‡Ø§ Ø¨Ø± ÙØ±Ø¢ÛŒÙ†Ø¯Ù‡Ø§ Ùˆ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§<br>Û². Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ø¹Ù…Ù„ÛŒØ§ØªÛŒ Ø¨Ø± Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø¬Ø§Ù…Ø¹<br>Û³. Ù‡Ù…Ú©Ø§Ø±ÛŒ Ø¨Ø§ Ù…Ø´ØªØ±ÛŒ Ø¨Ø± Ù…Ø°Ø§Ú©Ø±Ù‡ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯<br>Û´. Ù¾Ø§Ø³Ø® Ø¨Ù‡ ØªØºÛŒÛŒØ± Ø¨Ø± Ø¯Ù†Ø¨Ø§Ù„ Ú©Ø±Ø¯Ù† ÛŒÚ© Ø¨Ø±Ù†Ø§Ù…Ù‡' },
                    { type: 'q', text: 'Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù†ÙˆÛŒØ³ÛŒ Ù…ÙØ±Ø· (XP) Ú†ÛŒØ³Øª Ùˆ Ø§Ø±Ø²Ø´Ù‡Ø§ÛŒ Ø¢Ù† Ú©Ø¯Ø§Ù…Ù†Ø¯ØŸ' },
                    { type: 'a', text: 'XP Ù¾Ø±Ú©Ø§Ø±Ø¨Ø±Ø¯ØªØ±ÛŒÙ† Ø±ÙˆÛŒÚ©Ø±Ø¯ Ú†Ø§Ø¨Ú© Ø§Ø³Øª. Ø§Ø±Ø²Ø´Ù‡Ø§ÛŒ Ø¢Ù†: Ø§Ø±ØªØ¨Ø§Ø·Ø§ØªØŒ Ø³Ø§Ø¯Ú¯ÛŒØŒ Ø¨Ø§Ø²Ø®ÙˆØ±Ø¯ØŒ Ø¬Ø±Ø£ØªØŒ Ùˆ Ø§Ø­ØªØ±Ø§Ù….' },
                    { type: 'q', text: 'Ø§Ø³Ú©Ø±Ø§Ù… (Scrum) Ú†ÛŒØ³ØªØŸ' },
                    { type: 'a', text: 'ÛŒÚ© Ú†Ø§Ø±Ú†ÙˆØ¨ Ú†Ø§Ø¨Ú© Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ù‡Ø§ÛŒ Ø¨Ø§ ØªØºÛŒÛŒØ±Ø§Øª Ø²ÛŒØ§Ø¯ Ø§Ø³Øª. Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ø¯Ø± Ø¯ÙˆØ±Ù‡ Ù‡Ø§ÛŒÛŒ Ø¨Ù‡ Ù†Ø§Ù… Ø§Ø³Ù¾Ø±ÛŒÙ†Øª (Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ Û² ØªØ§ Û´ Ù‡ÙØªÙ‡) ØªÙˆØ³Ø¹Ù‡ Ù¾ÛŒØ¯Ø§ Ù…ÛŒÚ©Ù†Ø¯.' },
                ]
            },
            lesson4: {
                title: 'Ø¯Ø±Ø³ Û´: Ø§ØµÙˆÙ„ Ø±Ø§Ù‡Ù†Ù…Ø§', img: 'https://placehold.co/100x100/EF5350/FFFFFF?text=Û´', status: 'Ø¢Ù†Ù„Ø§ÛŒÙ†',
                messages: [
                    { type: 'q', text: 'Ø§ØµÙˆÙ„ Ù‡Ø³ØªÙ‡ Ø§ÛŒ Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ú©Ø¯Ø§Ù…Ù†Ø¯ØŸ' },
                    { type: 'a', text: 'Û±. ÙØ±Ø§Ù‡Ù… Ø³Ø§Ø®ØªÙ† Ø§Ø±Ø²Ø´ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±<br>Û². Ø­ÙØ¸ Ø³Ø§Ø¯Ú¯ÛŒ<br>Û³. Ø­ÙØ¸ Ú†Ø´Ù… Ø§Ù†Ø¯Ø§Ø²<br>Û´. Ø¯Ø§Ù†Ø³ØªÙ† Ø§ÛŒÙ†Ú©Ù‡ Ø¯ÛŒÚ¯Ø±Ø§Ù† Ù…Ø­ØµÙˆÙ„ Ø±Ø§ Ø¯Ø±Ú© Ø®ÙˆØ§Ù‡Ù†Ø¯ Ú©Ø±Ø¯<br>Ûµ. Ù†Ú¯Ø§Ù‡ Ø¨Ù‡ Ø¢ÛŒÙ†Ø¯Ù‡<br>Û¶. Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø±ÛŒØ²ÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…Ø¬Ø¯Ø¯<br>Û·. ØªÙÚ©Ø±' },
                    { type: 'q', text: 'Ù…Ù‡Ù…ØªØ±ÛŒÙ† Ø§ØµÙˆÙ„ Ø§Ø±ØªØ¨Ø§Ø·ÛŒ Ú†ÛŒØ³ØªØŸ' },
                    { type: 'a', text: 'Ú¯ÙˆØ´ Ø³Ù¾Ø±Ø¯Ù†ØŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø¯Ù† Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø±ØªØ¨Ø§Ø·ØŒ Ø§Ø±ØªØ¨Ø§Ø· Ø±ÙˆØ¯Ø±Ø±ÙˆØŒ ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ø¨Ø±Ø¯Ø§Ø±ÛŒØŒ Ùˆ ØªÙ„Ø§Ø´ Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ú©Ø§Ø±ÛŒ.' },
                    { type: 'q', text: 'Ù‚ÙˆØ§Ø¹Ø¯ Ø§ØµÙ„ÛŒ Ø¢Ø²Ù…ÙˆÙ† Ú†ÛŒØ³ØªØŸ' },
                    { type: 'a', text: 'Û±. Ø¢Ø²Ù…ÙˆÙ† ÙØ±Ø§ÛŒÙ†Ø¯ Ø§Ø¬Ø±Ø§ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø¨Ù‡ Ù‚ØµØ¯ ÛŒØ§ÙØªÙ† Ø®Ø·Ø§ Ø§Ø³Øª.<br>Û². ÛŒÚ© Ù…ÙˆØ±Ø¯ Ø¢Ø²Ù…ÙˆÙ† Ø®ÙˆØ¨ØŒ Ø®Ø·Ø§Ù‡Ø§ Ø±Ø§ Ø¨Ø§ Ø§Ø­ØªÙ…Ø§Ù„ Ø¨Ø§Ù„Ø§ÛŒÛŒ Ú©Ø´Ù Ù…ÛŒÚ©Ù†Ø¯.<br>Û³. Ø¢Ø²Ù…ÙˆÙ† Ù…ÙˆÙÙ‚ØŒ Ø¢Ø²Ù…ÙˆÙ†ÛŒ Ø§Ø³Øª Ú©Ù‡ ÛŒÚ© Ø®Ø·Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø±Ø§ Ú©Ø´Ù Ú©Ù†Ø¯.' },
                ]
            },
            quiz: {
                title: 'Ø¢Ø²Ù…ÙˆÙ† Ø¢Ù†Ù„Ø§ÛŒÙ†', img: 'https://placehold.co/100x100/26A69A/FFFFFF?text=âœ”ï¸', status: 'Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ú¯Ø²Ø§Ø±ÛŒ Ø¢Ø²Ù…ÙˆÙ†...'
            }
        };

        const quizQuestions = [
            { q: "Ú©Ø¯Ø§Ù… Ù…ÙˆØ±Ø¯ Ø¬Ø²Ùˆ Ø®ØµÙˆØµÛŒØ§Øª Ø§ØµÙ„ÛŒ Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ù†ÛŒØ³ØªØŸ", o: ["ÙØ±Ø³ÙˆØ¯Ù‡ Ù…ÛŒØ´ÙˆØ¯", "ÛŒÚ© Ø¹Ù†ØµØ± Ù…Ù†Ø·Ù‚ÛŒ Ø§Ø³Øª", "Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù…ÛŒØ´ÙˆØ¯", "Ø§ØºÙ„Ø¨ Ø³ÙØ§Ø±Ø´ÛŒ Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒØ´ÙˆØ¯"], a: 0 },
            { q: "Ú©Ø¯Ø§Ù… Ù„Ø§ÛŒÙ‡ØŒ Ù¾Ø§ÛŒÙ‡ Ùˆ Ø§Ø³Ø§Ø³ ØªÙ…Ø§Ù… Ù„Ø§ÛŒÙ‡ Ù‡Ø§ÛŒ Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ø§Ø³ØªØŸ", o: ["Ø±ÙˆØ´Ù‡Ø§", "ÙØ±Ø¢ÛŒÙ†Ø¯Ù‡Ø§", "ØªÙˆØ¬Ù‡ Ø¨Ù‡ Ú©ÛŒÙÛŒØª", "Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§"], a: 2 },
            { q: "Ø¯Ø± Ú©Ø¯Ø§Ù… Ù…Ø¯Ù„ ÙØ±Ø¢ÛŒÙ†Ø¯ØŒ Ù…Ø´ØªØ±ÛŒ Ø¨Ø§ÛŒØ¯ ØªØ§ Ø§Ù†ØªÙ‡Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¯Ù† Ù†Ø³Ø®Ù‡ Ú©Ø§Ø±ÛŒ ØµØ¨Ø± Ú©Ù†Ø¯ØŸ", o: ["Ú†Ø§Ø¨Ú©", "Ø¢Ø¨Ø´Ø§Ø±ÛŒ", "Ù…Ø§Ø±Ù¾ÛŒÚ†ÛŒ", "Ø§ÙØ²Ø§ÛŒØ´ÛŒ"], a: 1 },
            { q: "Ú©Ø¯Ø§Ù… Ù…Ø¯Ù„ Ù…Ø§Ù‡ÛŒØª ØªÚ©Ø±Ø§Ø±ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø³Ø§Ø²ÛŒ Ø±Ø§ Ø¨Ø§ Ú©Ù†ØªØ±Ù„ Ù…Ø¯Ù„ Ø¢Ø¨Ø´Ø§Ø±ÛŒ ØªÙ„ÙÛŒÙ‚ Ù…ÛŒÚ©Ù†Ø¯ØŸ", o: ["Ù…Ø¯Ù„ V", "Ù…Ø¯Ù„ Ø§ÙØ²Ø§ÛŒØ´ÛŒ", "Ù…Ø¯Ù„ Ù‡Ù…Ø±ÙˆÙ†Ø¯", "Ù…Ø¯Ù„ Ù…Ø§Ø±Ù¾ÛŒÚ†ÛŒ"], a: 3 },
            { q: "Ú©Ø¯Ø§Ù… Ù…ÙˆØ±Ø¯ Ø¬Ø²Ùˆ Ø§Ø±Ø²Ø´ Ù‡Ø§ÛŒ Ø¨ÛŒØ§Ù†ÛŒÙ‡ Ú†Ø§Ø¨Ú© Ù†ÛŒØ³ØªØŸ", o: ["Ø§ÙØ±Ø§Ø¯ Ùˆ ØªØ¹Ø§Ù…Ù„Ù‡Ø§ Ø¨Ø± ÙØ±Ø¢ÛŒÙ†Ø¯Ù‡Ø§", "Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ø¹Ù…Ù„ÛŒØ§ØªÛŒ Ø¨Ø± Ù…Ø³ØªÙ†Ø¯Ø§Øª", "Ù…Ø°Ø§Ú©Ø±Ù‡ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ø¨Ø± Ù‡Ù…Ú©Ø§Ø±ÛŒ Ø¨Ø§ Ù…Ø´ØªØ±ÛŒ", "Ù¾Ø§Ø³Ø® Ø¨Ù‡ ØªØºÛŒÛŒØ± Ø¨Ø± Ø¯Ù†Ø¨Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ø±Ù†Ø§Ù…Ù‡"], a: 2 },
            { q: "Ù¾Ø±Ú©Ø§Ø±Ø¨Ø±Ø¯ØªØ±ÛŒÙ† Ø±ÙˆÛŒÚ©Ø±Ø¯ Ø¯Ø± ØªÙˆØ³Ø¹Ù‡ Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ø¨Ù‡ Ø±ÙˆØ´ Ú†Ø§Ø¨Ú© Ú©Ø¯Ø§Ù… Ø§Ø³ØªØŸ", o: ["Ø§Ø³Ú©Ø±Ø§Ù… (Scrum)", "Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù†ÙˆÛŒØ³ÛŒ Ù…ÙØ±Ø· (XP)", "Ú©Ø§Ù†Ø¨Ø§Ù† (Kanban)", "Ù…Ø¯Ù„ V"], a: 1 },
            { q: "Ø¯ÙˆØ±Ù‡ Ù‡Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡ Ø¯Ø± Ø§Ø³Ú©Ø±Ø§Ù… Ú†Ù‡ Ù†Ø§Ù…ÛŒØ¯Ù‡ Ù…ÛŒØ´ÙˆÙ†Ø¯ØŸ", o: ["Ø§ÛŒØªØ±Ø´Ù† (Iteration)", "ÙØ§Ø² (Phase)", "Ø§Ø³Ù¾Ø±ÛŒÙ†Øª (Sprint)", "Ù†Ú¯Ø§Ø±Ø´ (Release)"], a: 2 },
            { q: "Ú©Ø¯Ø§Ù… Ø§ØµÙ„ Ø¨Ù‡ Ù…Ø¹Ù†Ø§ÛŒ 'Ù‡Ù†Ø± Ø¨Ù‡ Ø­Ø¯Ø§Ú©Ø«Ø± Ø±Ø³Ø§Ù†Ø¯Ù† Ú©Ø§Ø±Ù‡Ø§ÛŒÛŒ Ú©Ù‡ Ø§Ù†Ø¬Ø§Ù… Ù†Ù…ÛŒØ´ÙˆÙ†Ø¯' Ø§Ø³ØªØŸ", o: ["Ø¬Ø±Ø£Øª", "Ø¨Ø§Ø²Ø®ÙˆØ±Ø¯", "Ø§Ø­ØªØ±Ø§Ù…", "Ø³Ø§Ø¯Ú¯ÛŒ"], a: 3 },
            { q: "Ø§ØµÙ„ Ù¾Ø§Ø±ØªÙˆ Ø¯Ø± Ø¢Ø²Ù…ÙˆÙ† Ø¨Ù‡ Ú†Ù‡ Ù…Ø¹Ù†Ø§Ø³ØªØŸ", o: ["Ø¢Ø²Ù…ÙˆÙ† Ú©Ø§Ù…Ù„ Ø§Ù…Ú©Ø§Ù† Ù¾Ø°ÛŒØ± Ù†ÛŒØ³Øª", "Û¸Û°Ùª Ø®Ø·Ø§Ù‡Ø§ Ø¯Ø± Û²Û°Ùª Ù…Ø¤Ù„ÙÙ‡ Ù‡Ø§ ÛŒØ§ÙØª Ù…ÛŒØ´ÙˆÙ†Ø¯", "Ø¢Ø²Ù…ÙˆÙ† Ø¨Ø§ÛŒØ¯ Ø§Ø² Ú©ÙˆÚ†Ú© Ø¨Ù‡ Ø¨Ø²Ø±Ú¯ Ø¨Ø§Ø´Ø¯", "Ù‡Ù…Ù‡ Ø¢Ø²Ù…ÙˆÙ† Ù‡Ø§ Ø¨Ø§ÛŒØ¯ Ù‚Ø§Ø¨Ù„ Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ø¨Ø§Ø´Ù†Ø¯"], a: 1 },
            { q: "Ù…Ø¤Ø«Ø±ØªØ±ÛŒÙ† Ø±ÙˆØ´ Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø·Ø¨Ù‚ Ø§ØµÙˆÙ„ Ú†Ø§Ø¨Ú©ÛŒ Ú©Ø¯Ø§Ù… Ø§Ø³ØªØŸ", o: ["Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø¬Ø§Ù…Ø¹", "Ø§ÛŒÙ…ÛŒÙ„", "Ú¯ÙØªÚ¯ÙˆÛŒ Ø±ÙˆØ¯Ø±Ø±Ùˆ", "Ø¬Ù„Ø³Ø§Øª Ù‡ÙØªÚ¯ÛŒ"], a: 2 },
            { q: "Ú©Ø¯Ø§Ù… ÙØ¹Ø§Ù„ÛŒØª Ú†Ø§Ø±Ú†ÙˆØ¨ÛŒ Ø´Ø§Ù…Ù„ ØªÙˆÙ„ÛŒØ¯ Ú©Ø¯ Ùˆ Ø§Ù†Ø¬Ø§Ù… Ø¢Ø²Ù…ÙˆÙ† Ø§Ø³ØªØŸ", o: ["Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø±ÛŒØ²ÛŒ", "Ù…Ø¯Ù„ Ø³Ø§Ø²ÛŒ", "Ø³Ø§Ø®Øª", "Ø§Ø³ØªÙ‚Ø±Ø§Ø±"], a: 2 },
            { q: "Ø¨Ù‡ Ø³ÛŒØ³ØªÙ… Ù‡Ø§ÛŒ Ù†Ø±Ù… Ø§ÙØ²Ø§Ø±ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Ú©Ù‡ Ø¯Ù‡Ù‡ Ù‡Ø§ Ù‚Ø¨Ù„ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø§Ù†Ø¯ Ú†Ù‡ Ù…ÛŒÚ¯ÙˆÛŒÙ†Ø¯ØŸ", o: ["Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± ØªØ¹Ø¨ÛŒÙ‡ Ø´Ø¯Ù‡", "Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ù‚Ø¯ÛŒÙ…ÛŒ (Legacy)", "Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ø®Ø· ØªÙˆÙ„ÛŒØ¯", "Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ø³ÛŒØ³ØªÙ…ÛŒ"], a: 1 },
        ];

        // DOM Elements
        const chatItems = document.querySelectorAll('.chat-item');
        const messagesContainer = document.getElementById('messages-container');
        const chatHeaderTitle = document.getElementById('chat-header-title');
        const chatHeaderImg = document.getElementById('chat-header-img');
        const chatHeaderStatus = document.getElementById('chat-header-status');
        const mainContent = document.getElementById('main-content');
        const placeholder = document.getElementById('placeholder');
        const chatListContainer = document.getElementById('chat-list-container');
        const backButton = document.getElementById('back-button');
        const menuButton = document.getElementById('menu-button');
        const messageFooter = document.getElementById('message-footer');

        // State
        let currentChatId = null;
        let messageQueue = [];
        let isTyping = false;
        let quizState = { active: false, questions: [], currentQ: 0, score: 0 };

        // Functions
        const createMessageBubble = (msg) => {
            const bubbleWrapper = document.createElement('div');
            const bubble = document.createElement('div');
            bubbleWrapper.className = `flex mb-4 animate-fade-in ${msg.type === 'q' ? 'justify-end' : 'justify-start'}`;
            bubble.className = `p-3 max-w-lg shadow text-gray-800 ${msg.type === 'q' ? 'message-bubble-out' : 'message-bubble-in'}`;
            bubble.innerHTML = `<strong>${msg.type === 'q' ? 'Ø³ÙˆØ§Ù„' : 'Ù¾Ø§Ø³Ø®'}:</strong><br>${msg.text}`;
            bubbleWrapper.appendChild(bubble);
            return bubbleWrapper;
        };

        const processMessageQueue = () => {
            if (messageQueue.length === 0) { isTyping = false; return; }
            isTyping = true;
            const nextMessage = messageQueue.shift();
            showTypingIndicator();
            setTimeout(() => {
                removeTypingIndicator();
                const bubble = createMessageBubble(nextMessage);
                messagesContainer.appendChild(bubble);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                processMessageQueue();
            }, Math.random() * 1000 + 500);
        };
        
        const showTypingIndicator = () => { /* ... (same as before) ... */ };
        const removeTypingIndicator = () => { /* ... (same as before) ... */ };

        const switchChat = (chatId) => {
            if (isTyping) return;
            currentChatId = chatId;
            quizState.active = false;
            messageFooter.classList.remove('hidden');

            // Update header & active item
            chatHeaderTitle.textContent = chatData[chatId].title;
            chatHeaderImg.src = chatData[chatId].img;
            chatHeaderStatus.textContent = chatData[chatId].status;
            chatItems.forEach(item => item.classList.toggle('active-chat', item.dataset.chat === chatId));
            
            mainContent.classList.remove('hidden'); mainContent.classList.add('flex');
            placeholder.classList.add('hidden'); placeholder.classList.remove('md:flex');
            if (window.innerWidth < 768) { chatListContainer.classList.add('hidden'); }

            messagesContainer.innerHTML = '';
            if (chatId === 'quiz') {
                startQuiz();
            } else {
                messageQueue = [...chatData[chatId].messages];
                processMessageQueue();
            }
        };

        const startQuiz = () => {
            quizState.active = true;
            messageFooter.classList.add('hidden');
            messagesContainer.innerHTML = '';

            // Shuffle and pick 10 questions
            const shuffled = [...quizQuestions].sort(() => 0.5 - Math.random());
            quizState.questions = shuffled.slice(0, 10);
            quizState.currentQ = 0;
            quizState.score = 0;

            const startBubble = document.createElement('div');
            startBubble.className = 'message-bubble-in p-4 text-center animate-fade-in';
            startBubble.innerHTML = `<h3 class="text-xl font-bold mb-2">Ø¢Ø²Ù…ÙˆÙ† Ø´Ø±ÙˆØ¹ Ø´Ø¯!</h3><p>Ø¨Ø±Ø§ÛŒ Û±Û° Ø³ÙˆØ§Ù„ Ø¨Ø¹Ø¯ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø§Ø´ÛŒØ¯. Ù…ÙˆÙÙ‚ Ø¨Ø§Ø´ÛŒØ¯!</p>`;
            messagesContainer.appendChild(startBubble);
            
            setTimeout(displayQuizQuestion, 2000);
        };

        const displayQuizQuestion = () => {
            if (quizState.currentQ >= quizState.questions.length) {
                showQuizResult();
                return;
            }
            const q = quizState.questions[quizState.currentQ];
            const questionBubble = document.createElement('div');
            questionBubble.className = 'message-bubble-in p-4 w-full animate-fade-in';
            let optionsHTML = q.o.map((opt, index) => 
                `<button data-index="${index}" class="quiz-option w-full text-right p-3 my-1 rounded-lg font-semibold">${opt}</button>`
            ).join('');

            questionBubble.innerHTML = `
                <p class="mb-3 font-bold text-md">Ø³ÙˆØ§Ù„ ${quizState.currentQ + 1} Ø§Ø² ${quizState.questions.length}: ${q.q}</p>
                <div class="options-container">${optionsHTML}</div>
            `;
            messagesContainer.appendChild(questionBubble);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            document.querySelectorAll('.quiz-option').forEach(btn => {
                btn.addEventListener('click', handleAnswer);
            });
        };

        const handleAnswer = (e) => {
            const selectedIndex = parseInt(e.target.dataset.index);
            const question = quizState.questions[quizState.currentQ];
            const options = document.querySelectorAll('.quiz-option');

            // Disable all options
            options.forEach(opt => opt.disabled = true);

            if (selectedIndex === question.a) {
                quizState.score++;
                e.target.classList.add('correct');
            } else {
                e.target.classList.add('incorrect');
                options[question.a].classList.add('correct');
            }

            quizState.currentQ++;
            setTimeout(displayQuizQuestion, 2000);
        };

        const showQuizResult = () => {
            const score = quizState.score;
            const total = quizState.questions.length;
            const percentage = Math.round((score / total) * 100);
            let message = `Ø¹Ø§Ù„ÛŒ Ø¨ÙˆØ¯! Ø´Ù…Ø§ Ø¨Ù‡ ${score} Ø³ÙˆØ§Ù„ Ø§Ø² ${total} Ù¾Ø§Ø³Ø® ØµØ­ÛŒØ­ Ø¯Ø§Ø¯ÛŒØ¯. (${percentage}%)`;
            if (percentage < 50) message = `Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙ„Ø§Ø´ Ø¨ÛŒØ´ØªØ±ÛŒ Ø¯Ø§Ø±ÛŒØ¯. Ø´Ù…Ø§ Ø¨Ù‡ ${score} Ø³ÙˆØ§Ù„ Ø§Ø² ${total} Ù¾Ø§Ø³Ø® ØµØ­ÛŒØ­ Ø¯Ø§Ø¯ÛŒØ¯. (${percentage}%)`;
            else if (percentage < 80) message = `Ø®ÙˆØ¨ Ø¨ÙˆØ¯! Ø´Ù…Ø§ Ø¨Ù‡ ${score} Ø³ÙˆØ§Ù„ Ø§Ø² ${total} Ù¾Ø§Ø³Ø® ØµØ­ÛŒØ­ Ø¯Ø§Ø¯ÛŒØ¯. (${percentage}%)`;
            
            const resultBubble = document.createElement('div');
            resultBubble.className = 'message-bubble-in p-4 text-center animate-fade-in';
            resultBubble.innerHTML = `
                <h3 class="text-xl font-bold mb-2">Ø¢Ø²Ù…ÙˆÙ† ØªÙ…Ø§Ù… Ø´Ø¯!</h3>
                <p class="mb-4">${message}</p>
                <button id="restart-quiz-btn" class="bg-blue-500 text-white font-bold py-2 px-4 rounded-full hover:bg-blue-600">Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯ Ø¢Ø²Ù…ÙˆÙ†</button>
            `;
            messagesContainer.appendChild(resultBubble);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            document.getElementById('restart-quiz-btn').addEventListener('click', () => switchChat('quiz'));
        };

        // Event Listeners
        chatItems.forEach(item => item.addEventListener('click', () => switchChat(item.dataset.chat)));
        backButton.addEventListener('click', () => {
            chatListContainer.classList.remove('hidden');
            mainContent.classList.add('hidden'); mainContent.classList.remove('flex');
        });
        menuButton.addEventListener('click', () => alert('Ù…Ù†Ùˆ Ø¯Ø± Ø­Ø§Ù„ Ø³Ø§Ø®Øª Ø§Ø³Øª!'));

        // Initial Setup
        const style = document.createElement('style');
        style.innerHTML = `@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } } .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }`;
        document.head.appendChild(style);
        
        if (window.innerWidth >= 768) {
            placeholder.classList.remove('hidden');
            mainContent.classList.add('hidden'); mainContent.classList.remove('flex');
        } else {
             mainContent.classList.add('hidden'); mainContent.classList.remove('flex');
             placeholder.classList.add('hidden'); placeholder.classList.remove('md:flex');
        }

        switchChat('intro');
    });
    </script>
</body>
</html>
